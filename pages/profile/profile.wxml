<!--æˆ‘çš„å®é¡µé¢-->
<view class="container {{containerClass}}">
  <!-- å®å®ä¿¡æ¯å¡ç‰‡ -->
  <view class="baby-card">
    <!-- å¤´åƒåŒºåŸŸ -->
    <view class="avatar-section {{containerClass}}" bindtap="changeAvatar">
      <view class="avatar-container">
        <image 
          class="avatar" 
          src="{{babyInfo.avatar || '/images/default-avatar.png'}}" 
          mode="aspectFill"
          binderror="onAvatarError"
        ></image>
        <view class="avatar-edit">
          <image src="/images/icons/camera.svg" style="width: 24rpx; height: 24rpx;"></image>
        </view>
      </view>
    </view>

    <!-- ä¿¡æ¯åŒºåŸŸ -->
    <view class="info-area">
      <!-- å§“å -->
      <view class="info-row" bindtap="editField" data-field="name">
        <view class="info-left">
          <image class="info-icon" src="/images/icons/user.svg"></image>
          <text class="info-label">å§“å</text>
        </view>
        <view class="info-right">
          <text class="info-value">{{babyInfo.name || 'ç‚¹å‡»è®¾ç½®'}}</text>
          <image class="arrow-icon" src="/images/icons/chevron-right.svg"></image>
        </view>
      </view>

      <!-- æ€§åˆ« -->
      <view class="info-row" bindtap="editField" data-field="gender">
        <view class="info-left">
          <image class="info-icon" src="/images/icons/users.svg"></image>
          <text class="info-label">æ€§åˆ«</text>
        </view>
        <view class="info-right">
          <text class="info-value">{{genderText || 'ç‚¹å‡»è®¾ç½®'}}</text>
          <image class="arrow-icon" src="/images/icons/chevron-right.svg"></image>
        </view>
      </view>

      <!-- ç”Ÿæ—¥ -->
      <view class="info-row" bindtap="editField" data-field="birthday">
        <view class="info-left">
          <image class="info-icon" src="/images/icons/calendar.svg"></image>
          <text class="info-label">ç”Ÿæ—¥</text>
        </view>
        <view class="info-right">
          <view class="birthday-info">
            <text class="info-value">{{babyInfo.birthday || 'ç‚¹å‡»è®¾ç½®'}}</text>
            <text class="age-text" wx:if="{{babyInfo.birthday}}">{{ageText}}</text>
          </view>
          <image class="arrow-icon" src="/images/icons/chevron-right.svg"></image>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- ç¼–è¾‘å¼¹çª— -->
<view class="modal" wx:if="{{showEditModal}}" bindtap="closeModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">ç¼–è¾‘{{editFieldName}}</text>
      <view class="modal-close" bindtap="closeModal">Ã—</view>
    </view>
    
    <view class="modal-body">
      <!-- æ–‡æœ¬è¾“å…¥ -->
      <input 
        class="modal-input" 
        placeholder="è¯·è¾“å…¥{{editFieldName}}"
        value="{{editValue}}"
        bindinput="onEditInput"
        wx:if="{{editType === 'text'}}"
      />
      
      <!-- æ—¥æœŸé€‰æ‹© -->
      <picker 
        mode="date" 
        value="{{editValue}}" 
        bindchange="onDateSelect"
        wx:if="{{editType === 'date'}}"
      >
        <view class="modal-input">{{editValue || 'é€‰æ‹©æ—¥æœŸ'}}</view>
      </picker>
      
      <!-- å•é€‰é€‰æ‹© -->
      <view class="radio-group" wx:if="{{editType === 'radio'}}">
        <view 
          class="radio-option {{item.value === editValue ? 'active' : ''}}"
          wx:for="{{editOptions}}" 
          wx:key="value"
          bindtap="onRadioSelect"
          data-value="{{item.value}}"
        >
          {{item.label}}
        </view>
      </view>
    </view>
    
    <view class="modal-footer">
      <button class="modal-btn modal-btn-cancel" bindtap="closeModal">å–æ¶ˆ</button>
      <button class="modal-btn modal-btn-confirm" bindtap="confirmEdit">ç¡®å®š</button>
    </view>
  </view>
</view>

<!-- æ·»åŠ è®°å½•å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showModal}}" bindtap="hideModal">
        <view class="modal-content" catchtap="stopPropagation">
        <view class="modal-body">
          <view class="form-group">
            <text class="form-label">èº«é«˜ (cm)</text>
            <input 
              class="form-input" 
              type="number" 
              placeholder="ä¾‹å¦‚ï¼š68.5" 
              value="{{modalData.height}}"
              bindinput="onModalInput"
              data-field="height"
              maxlength="5"
            />
          </view>

          <view class="form-group">
            <text class="form-label">ä½“é‡ (kg)</text>
            <input 
              class="form-input" 
              type="number" 
              placeholder="ä¾‹å¦‚ï¼š8.5" 
              value="{{modalData.weight}}"
              bindinput="onModalInput"
              data-field="weight"
              maxlength="5"
            />
          </view>

          <view class="form-group">
            <text class="form-label">å¤´å›´ (cm)</text>
            <input 
              class="form-input" 
              type="number" 
              placeholder="ä¾‹å¦‚ï¼š42.5" 
              value="{{modalData.head}}"
              bindinput="onModalInput"
              data-field="head"
              maxlength="5"
            />
          </view>

          <view class="form-group">
            <text class="form-label">è®°å½•æ—¥æœŸ</text>
            <picker mode="date" value="{{modalData.date}}" bindchange="onModalDateChange">
              <view class="form-input picker-input">
                <text class="picker-text">{{modalData.date || 'ç‚¹å‡»é€‰æ‹©æ—¥æœŸ'}}</text>
                <text class="picker-arrow">ğŸ“…</text>
              </view>
            </picker>
          </view>
        </view>

    <view class="modal-footer">
      <button class="btn btn-cancel" bindtap="hideModal">å–æ¶ˆ</button>
      <button class="btn btn-primary" bindtap="submitRecord" disabled="{{submitting}}">
        {{submitting ? 'ä¿å­˜ä¸­...' : 'ç¡®å®š'}}
      </button>
    </view>
  </view>
</view> 